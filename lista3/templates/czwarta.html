<!DOCTYPE html>
<html>

<head>
    <title>inteligent_dom</title>
    <style>
        table,
        th,
        td {
            border: 1px solid black;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        const url = 'grzejnik';
        function myFunction() {
            $.get(url, function (data, status) {
                console.log(`${data} and status is ${status}`);
                $("#status_grzejnik").text(`${data}`);
            });
        }

        const url2 = 'okno';
        function okno() {
            $.get(url2, function (data, status) {
                console.log(`${data} and status is ${status}`);
                $("#status_okna").text(`${data}`);
            });
        }
    </script>
    <script>

        function zmiana_interwalu(port) {
            var x = document.getElementById("freq").value;
            const url = `zmiana_interwalu?freq=${x}&port=${port}`
            $.get(url, function (data, status) {
                console.log(`${data} and status is ${status}`);
            });
        }
    </script>
    <style type="text/css">
    body {background-color: lightgrey;
    font-family: Verdana;
    font-size: 14px;
    color:rgb(71, 69, 69);
    font-family: 'Lato','sans-serif';
    margin:0 !important;}


    </style>
</head>

<body>
    <div style="  margin-top: 10px;
    margin-bottom: 10px;
    text-align: center;
    margin-left: auto;
    margin-right: auto;
    color: #50159c;
    font-size:30px;
    letter-spacing: 2px;
    font:bold;
    font-family:Verdana; ">
        <h1>Inteligenty Dom</h1>
    </div>

    <div style="    color: #101010;
    margin-top: 10px;
    text-align: center;
    font-size: 25px;
    margin-left: auto;
    margin-right: auto;">
    <p>Aplikacja zbierające dane na temat produkcji i zużycia prądu w mieszkaniu </p>
    </div>


    <div id='sub1' style="height: 100px; width:200px; float:left; text-align: center; margin-left: 50px; ">
        <p>WŁĄCZ/WYŁĄCZ GRZEJNIK.</p>
        <button onclick="myFunction()" style="width: 150px;
        color:white;
        background-color: #388017;
        border: 3px solid #7fad73;
        border-radius: 5px;
        font-size: 22px;
        padding: 15px 10px;
        cursor:pointer;
        padding: 10px;
        margin-left: 20px;
        margin-right: 20px;">GRZEJNIK</button>
        <p id="status_grzejnik"></p>
    </div>
    <div id='sub2' style="height: 100px; width:200px; float:left;  text-align: center;">
        <p>OTWÓRZ/ZAMKNIJ OKNO</p>
        <button onclick="okno()" style="width: 150px;
        color:white;
        background-color: #388017;
        border: 3px solid #7fad73;
        border-radius: 5px;
        font-size: 22px;
        padding: 15px 10px;
        cursor:pointer;
        padding: 10px;
        margin-left: 20px;
        margin-right: 20px;">OKNO</button>
        <p id="status_okna"></p>
    </div>
    <div id="ALERTgrzejnik" style="float: left;"></div>
    <div id="ALERTokno" style="float: left;"></div>
    <div style="clear:both;"></div>
    <br>
    <br>
    <br>


    <div style="width: 230px; height: 100px; float: left; margin-left: 20px; margin-right: 10px;  border-right: 2px dotted #c0b5b5">
        <p>zmiana częstotliwości w aplikacji 1</p>
        <select id="freq" onchange="zmiana_interwalu(2321)" style="height:30px; width: 50px; background-color: #cdf5c3;">
            <option value="15">15</option>
            <option value="30">30</option> <option value="45">45</option>
            <option value="60">60</option>
        </select>
        <br>

    </div>

    <div style="width: 230px; height: 100px; float: left;margin-right: 10px;  border-right: 2px dotted #c0b5b5">
        <p>zmiana częstotliwości w aplikacji 2</p>
        <select id="freq" onchange="zmiana_interwalu(2322)" style="height:30px; width: 50px; background-color: #cdf5c3;">
            <option value="15">15</option>
            <option value="30">30</option>
            <option value="45">45</option>
            <option value="60">60</option>
        </select>
        <br>

    </div>

    <div style="width: 230px; height: 100px; float: left;margin-right: 10px;  border-right: 2px dotted #c0b5b5">
        <p>zmiana częstotliwości w aplikacji 3</p>
        <select id="freq" onchange="zmiana_interwalu(2323)" style="height:30px; width: 50px; background-color: #cdf5c3;">
            <option value="15">15</option>
            <option value="30">30</option>
            <option value="45">45</option>
            <option value="60">60</option>
        </select>
        <br>

    </div>

    <div style="width: 230px; height: 100px; float: left;margin-right: 10px;  border-right: 2px dotted #c0b5b5">
        <p>zmiana częstotliwości w aplikacji 4</p>
        <select id="freq" onchange="zmiana_interwalu(2324)" style="height:30px; width: 50px; background-color: #cdf5c3;">
            <option value="15">15</option>
            <option value="30">30</option>
            <option value="45">45</option>
            <option value="60">60</option>
        </select>
        <br>

    </div>

    <div style="width: 230px; height: 100px; float: left;">
        <p>zmiana częstotliwości w aplikacji 5</p>
        <select id="freq" onchange="zmiana_interwalu(2325)" style="height:30px; width: 50px; background-color: #cdf5c3;">
            <option value="15">15</option>
            <option value="30">30</option>
            <option value="45">45</option>
            <option value="60">60</option>
        </select>
        <br>

    </div>

    <div style="clear: both;"></div>

    <br>

    <div style="background-color:  rgb(1, 96, 128);  color: cornsilk; margin-top: 20px;border-radius: 5px;">

    {% for nazwa_apki, dane_z_apki in zbior_danych['sensory'].items() %}
    <h2>Aplikacja {{nazwa_apki}} </h2>
    {% if dane_z_apki|count == 0 %}


    <p> Aplikacja wyłączona </p>
    {% else %}
    <p>Aplikacja włączona</p>

    <table id= "myTable" style="width:300px;">
        <tr>
            {% for klucz in dane_z_apki[0] %}
            <th>{{klucz}}</th>
            {% endfor %}

        </tr>
        {% for dane in dane_z_apki %}
        <tr>
            {% for wartosc in dane.values() %}
            <td> {{ wartosc }} </td>



            {% endfor %}

        </tr>
        {% endfor %}

    </table>
    <script>
        const x = document.getElementById("myTable").rows[1].getElementsByTagName('td');
        var grzej = document.getElementById('sub1');
        var okok = document.getElementById('sub1');

        var isFocusedGrzej= (document.activeElement === grzej);
        var isFocusedOkok= (document.activeElement === okok);

        if (x>30)
        {
            if( isFocusedGrzej == true)
            {
                document.getElementById("ALERTgrzejnik").innerHTML=("WYŁĄCZ GRZEJNIK");
            }
        }
        if (x<20)
        {
            if( isFocusedGrzej == false)
            {
                document.getElementById("ALERTgrzejnik").innerHTML=("WŁĄCZ GRZEJNIK");
            }
        }

        if (x<15)
        {
            if (isFocusedOkok == false)
            {
                document.getElementById("ALERTokno").innerHTML=("ZAMKNIJ OKNO");
            }
        }
    </script>

    {% endif %}
    <br>

</div>
<br>
<div style="clear:both"></div>

    <div style="background-color:  rgb(1, 96, 128);  color: cornsilk; margin-top: 20px;border-radius: 5px;">
        {% if nazwa_apki == 'sensor_pogodowy' %}
        <h3> Średnia z temperatury powietrza: {{zbior_danych['srednie']['srednia_temperaturowa_powietrza']}}</h3>
    </div>

    <div style="background-color:  rgb(1, 96, 128); color: cornsilk;margin-right: 10px;border-radius: 5px;">
    {% elif nazwa_apki == 'sensor_temperatury' %}
    <h3> Średnia z temperatury w domu: {{zbior_danych['srednie']['srednia_temperatury_w_domu']}}</h3>
    </div>
    <div style="background-color:  rgb(1, 96, 128); color: cornsilk;margin-right: 10px;border-radius: 5px;">
    {% elif nazwa_apki == 'sensor_z_licznika_pradu' %}
    <h3> Średnia zużytego pradu: {{zbior_danych['srednie']['srednia_zuzycia_pradu']}} </h3>
</div>
    <div style="background-color:  rgb(1, 96, 128); color: cornsilk;margin-right: 10px;border-radius: 5px;">
    {% elif nazwa_apki == 'sensor_z paneli' %}
    <h3> Średnia z wyprodukowanego prądu:{{zbior_danych['srednie']['srednia_produkcji']}} </h3>
</div>
    <div style="background-color:  rgb(1, 96, 128);color: cornsilk;border-radius: 5px;">
    {% elif nazwa_apki == 'sensor_ilosci_osob' %}
    <h3> Średnia z ilości osób w domu: {{zbior_danych['srednie']['srednia_ludzi']}}</h3>
</div>

<div style="clear:both"></div>
    {% endif %}
    <br>
    {% endfor %}

    <br>





</body>

</html>